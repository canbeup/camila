<roundcube:object name="doctype" value="html5" />
<html>

<head>
  <title>
    <roundcube:object name="pagetitle" />
  </title>
  <roundcube:include file="/includes/links.html" />
  <link rel="stylesheet" type="text/css" href="/thirdparty/materialize/css/materialize.css" />
  <link rel="stylesheet" type="text/css" href="/styles/dist/addressbook.css" />
</head>

<body class="noscroll">

  <roundcube:include file="/includes/header.html" />

  <div id="addressbook-component">
    <!-- toolbar -->
    <div class="row toolbar" id="toolbar-and-search">
      <div class="col xs12 s12 m12 l8 xl8">
        <h2 id="aria-label-toolbar" class="voice"><roundcube:label name="arialabeltoolbar" /></h2>
        <div id="addressbooktoolbar" class="toolbar" role="toolbar" aria-labelledby="aria-label-toolbar">
          <roundcube:include file="/includes/addressbooktoolbar.html" />
        </div>
      </div>
      <div class="col l4 xl4 hide-on-med-and-down">
        <div class="row" id="search-box-container">
  				<div class="col l5 xl5 right-align hide-on-med-and-down" id="buttons-container">
  					<div id="quicksearchcombo">
  						<h2 id="aria-label-searchform" class="voice"><roundcube:label name="arialabelmailsearchform" /></h2>
  					  <label for="quicksearchbox" class="voice"><roundcube:label name="arialabelmailquicksearchbox" /></label>
              <roundcube:button command="menu-open" prop="searchmenu" type="link" class="btn toolbar-button z-depth-0" id="searchmenulink" title="searchmod" label="options" aria-haspopup="true" aria-expanded="false" aria-owns="searchmenu-menu" />
  					</div>
  				</div>
  				<div class="col l7 xl7 hide-on-med-and-down" id="form-container">
  					<roundcube:object name="searchform" id="quicksearchbox" />
  				</div>
  			</div>
      </div>
    </div>
    <div class="row">
      <div class="col s12 m12 l2 xl2 hide-on-med-and-down" id="settings-tab">
        <div class="settings-tab-container">
          <div class="header">
            <div id="directorylist-header" class="groups-header">
              <roundcube:label name="groups" />
            </div>
          </div>
          <div class="settings-tab">
            <div id="directorylistbox" role="navigation" aria-labelledby="directorylist-header">
              <roundcube:object name="directorylist" id="directorylist" />
              <div class="saved-searches-header" style="display: none">
                <roundcube:label name="savedsearches" />
              </div>
              <roundcube:object name="savedsearchlist" id="savedsearchlist" />
            </div>
          </div>
          <div class="footer">
            <div class="row">
              <div class="col s6 m6 l6 xl6 left-align">
                <roundcube:button command="group-create" type="link" title="newgroup" innerClass="inner" label="addgroup" id="add-group" />
              </div>
              <div class="col s6 m6 l6 xl6 right-align">
                <roundcube:button name="groupoptions" id="groupoptionslink" type="link" title="moreactions" onclick="return UI.toggle_popup('groupoptions',event)" innerClass="inner" label="arialabelabookgroupoptions" aria-haspopup="true" aria-expanded="false" aria-owns="groupoptionsmenu"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col s12 m12 l3 xl3" id="sections-tab">
        <div class="sections-tab-container">
          <div class="header">
            <div class="col xs2 s2 m2 l2 xl2">
              <div class="hide-on-large-only">

              </div>
            </div>
            <div class="col xs6 s6 m6 l6 xl6">
              <roundcube:object name="addresslisttitle" label="contacts" tag="div" class="contacts-header" id="aria-label-contactslist" />
            </div>
            <div class="col xs4 s4 m4 l4 xl4 right-align">
              <span id="pagenavigation-buttons">
                <roundcube:button command="firstpage" type="link" class="navbutton firstpage" classAct="navbutton firstpage" classSel="navbutton firstpage pressed" title="firstpage" label="first" />
                <roundcube:button command="previouspage" type="link" class="navbutton prevpage disabled" classAct="navbutton prevpage" classSel="navbutton prevpage pressed" title="previouspage" label="previous" />
                <roundcube:button command="nextpage" type="link" class="navbutton nextpage disabled" classAct="navbutton nextpage" classSel="navbutton nextpage pressed" title="nextpage" label="next" />
                <roundcube:button command="lastpage" type="link" class="navbutton lastpage disabled" classAct="navbutton lastpage" classSel="navbutton lastpage pressed" title="lastpage" label="last" />
              </span>
            </div>
          </div>
          <div class="sections-tab">
            <roundcube:object name="addresslist" id="contacts-table" noheader="true" role="listbox" />
          </div>
          <div class="footer">
            <div class="row">
              <div class="col xs3 s3 m3 l3 xl3 center-align">
                <roundcube:button command="add" type="link" title="newcontact" label="addcontact" id="add-contact" />
              </div>
              <div class="col xs3 s3 m3 l3 xl3 center-align">
                <roundcube:button command="group-remove-selected" type="link" title="groupremoveselected" label="groupremoveselected" id="delete-group-contacts" />
              </div>
              <div class="col s6 m6 l6 xl6 center-align">
                <span class="countdisplay" aria-live="polite" aria-relevant="text">
          			<span class="voice"><roundcube:label name="contacts" /></span>
                <roundcube:object name="recordsCountDisplay" label="fromtoshort" />
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col s12 m12 l7 xl7 hide-on-med-and-down" id="form-tab">
        <div class="form-tab-container">
          <div class="header">
            <div class="col xs2 s2 m2 l2 xl2 left-align">
              <div class="hide-on-med-and-up">
                <span class="back-button" id="form-back"><i class="material-icons left">arrow_back</i></span><br />
              </div>
            </div>
            <div class="col xs8 s8 m8 l8 xl8 center-align">
              Contacto
            </div>
            <div class="col xs2 s2 m2 l2 xl2 right-align">
              <roundcube:button command="delete" type="link" title="deletecontact" label="deletecontact" id="delete-contact" />
            </div>
          </div>
          <div class="form-tab">
            <div class="iframebox">
              <roundcube:object name="addressframe" id="contact-frame" style="width:100%; height:100%" frameborder="0" src="/watermark.html" title="arialabelpreferencesform" scrolling="yes" />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="groupoptions" class="popupmenu" aria-hidden="true">
    <h3 id="aria-label-groupoptions" class="voice"><roundcube:label name="arialabelabookgroupoptions" /></h3>
    <ul id="groupoptionsmenu" class="toolbarmenu" role="menu" aria-labelledby="aria-label-groupoptions">
      <roundcube:button type="link-menuitem" command="group-rename" label="grouprename" classAct="active" />
      <roundcube:button type="link-menuitem" command="group-delete" label="groupdelete" classAct="active" />
      <roundcube:button type="link-menuitem" command="search-create" label="searchsave" classAct="active" />
      <roundcube:button type="link-menuitem" command="search-delete" label="searchdelete" classAct="active" />
      <roundcube:container name="groupoptions" id="groupoptionsmenu" />
    </ul>
  </div>
  <div id="searchmenu" class="popupmenu" data-editable="true">
    <h3 id="aria-label-searchmenu" class="voice"><roundcube:label name="searchmod" /></h3>
    <ul class="toolbarmenu" id="searchmenu-menu" role="menu" aria-labelledby="aria-label-searchmenu">
      <li role="menuitem"><label><input type="checkbox" name="s_mods[]" value="name" id="s_mod_name" onclick="UI.set_searchmod(this)" /> <span><roundcube:label name="name" /></span></label></li>
      <li role="menuitem"><label><input type="checkbox" name="s_mods[]" value="firstname" id="s_mod_firstname" onclick="UI.set_searchmod(this)" /> <span><roundcube:label name="firstname" /></span></label></li>
      <li role="menuitem"><label><input type="checkbox" name="s_mods[]" value="surname" id="s_mod_surname" onclick="UI.set_searchmod(this)" /> <span><roundcube:label name="surname" /></span></label></li>
      <li role="menuitem"><label><input type="checkbox" name="s_mods[]" value="email" id="s_mod_email" onclick="UI.set_searchmod(this)" /> <span><roundcube:label name="email" /></span></label></li>
      <li role="menuitem"><label><input type="checkbox" name="s_mods[]" value="*" id="s_mod_all" onclick="UI.set_searchmod(this)" /> <span><roundcube:label name="allfields" /></span></label></li>
    </ul>
    <div class="buttons">
      <a class="button" href="#" onclick="if (rcmail.command('search')) UI.show_popup('searchmenu',false)">
        <roundcube:label name="search" />
      </a>
    </div>
  </div>
</body>
<script type="text/javascript">
  $('#add-group').html('<i class="material-icons">add</i>');
  $('#groupoptionslink').html('<i class="material-icons">settings</i>');
  $('#add-contact').html('<i class="material-icons">add</i>');
  $('#delete-contact').html('<i class="material-icons">delete</i>');
  $('#delete-group-contacts').html('<i class="material-icons">remove_circle</i>');
  $('#searchmenulink').html('<i class="material-icons">search</i>');
  $('#searchmenu > .buttons').remove();
</script>
<script type="text/javascript">
  var buttons = [
    // class, icon
    ['.import', 'import_contacts'],
    ['.export', 'import_export', 'exportmenulink'],
    ['.compose', 'email'],
    ['.print', 'print'],
    ['.search', 'search']
  ];
  buttons.forEach(function(tuple) {
    var klass = tuple[0];
    var icon = tuple[1];
    var link = tuple[2];

    $('#addressbooktoolbar').find(klass).html('<i class="material-icons left">{}</i><span class="hide-on-med-and-down">{}</span>'.format(icon, $('#addressbooktoolbar').find(klass).html()));

    if (link !== undefined) {
      $('#mailtoolbar').find(klass).html($(tuple[0]).html() + '<i class="material-icons right" id="{}-clicker">arrow_drop_down</i>'.format(link));
      $('#{}-clicker'.format(link)).on('click', function(e) {
        e.stopPropagation();
        $('#{}'.format(link)).click();
      })
    }
  });
</script>
<script>
  var navbuttons = [
    // class, icon
    ['.firstpage', 'skip_previous'],
    ['.prevpage', 'fast_rewind'],
    ['.nextpage', 'fast_forward'],
    ['.lastpage', 'skip_next']
  ];
  navbuttons.forEach(function(tuple) {
    var klass = tuple[0];
    var icon = tuple[1];

    $('#pagenavigation-buttons').find(klass).html('<i class="tiny material-icons">{}</i>'.format(icon));
  });
</script>
<script>
  const mq = window.matchMedia("(max-width: 992px)");

  mq.addListener(handleMediaQuery);

  function handleMediaQuery(mediaQuery) {
    if (mediaQuery.matches) {
      $('#header-component').addClass('mobile-header');

      $('.sections-tab').find('tr').on('click touchstart', function(e) {
        $('#sections-tab').addClass('hide-on-med-and-down');
        $('#form-tab').removeClass('hide-on-med-and-down');
      });
      var add_button = $('#add-contact');
      add_button.click(function(e) {
        $('#sections-tab').addClass('hide-on-med-and-down');
        $('#form-tab').removeClass('hide-on-med-and-down');
      });
    } else {
      $('#header-component').removeClass('mobile-header');
    }
  }

  $(document).ready(function() {
    setTimeout(function() {
      handleMediaQuery(mq);
    }, 500);
  });

  $('#form-back').on('click', function(e) {
    $('#settings-tab').addClass('hide-on-med-and-down');
    $('#sections-tab').removeClass('hide-on-med-and-down');
    $('#form-tab').addClass('hide-on-med-and-down');
  });
</script>

<script defer>
  function toggleBodyWidth() {
    var rosterClass = $('#jsxc_roster').attr('class');
    if (rosterClass === 'jsxc_state_shown') {
      $('body').css('width', 'calc(100vw - 200px)');
    } else {
      $('body').css('width', '100%');
    }
  }
  $(document).ready(function() {
    $(document).on('ready.roster.jsxc', function (event) {
      $('#jsxc_toggleRoster').on('click', toggleBodyWidth);
      toggleBodyWidth();
    });
  });
</script>

</html>
